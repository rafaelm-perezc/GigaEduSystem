<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;">
    <title>Giga-Edu ERP | Panel Principal</title>
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="/sweetalert2/sweetalert2.all.min.js"></script>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark shadow-sm">
    <div class="container">
        <span class="navbar-brand mb-0 h1">Giga-Edu ERP</span>
        <div class="d-flex align-items-center">
            <span class="text-white me-3">ğŸ‘¤ Hola, <%= usuario.primer_nombre %> <%= usuario.primer_apellido %> (<%= usuario.rol %>)</span>
            <button onclick="confirmarSalida()" class="btn btn-outline-light btn-sm">Cerrar SesiÃ³n</button>
        </div>
    </div>
</nav>

<div class="container mt-5">
    <div class="text-center mb-5">
        <h2 class="text-primary fw-bold">Panel de Control Principal</h2>
        <p class="text-muted">Seleccione el mÃ³dulo al que desea ingresar</p>
    </div>
    
    <div class="row justify-content-center g-4">
        
        <% if (usuario.rol === 'ADMIN' || usuario.rol === 'SECRETARIA' || usuario.rol === 'DOCENTE') { %>
            <div class="col-md-4">
                <a href="/admin/configuracion" class="btn btn-dark btn-lg w-100 py-4 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-4 mb-2">âš™ï¸</span> ConfiguraciÃ³n Institucional
                </a>
            </div>
            <div class="col-md-4">
                <a href="/admin/academico" class="btn btn-primary btn-lg w-100 py-4 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-4 mb-2">ğŸ“š</span> Plan de Estudios y Ãreas
                </a>
            </div>
            <div class="col-md-4">
                <a href="/admin/asignacion" class="btn btn-success btn-lg w-100 py-4 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-4 mb-2">ğŸ‘¨â€ğŸ«</span> Personal y Cargas
                </a>
            </div>
            
            <div class="col-md-4">
                <a href="/admin/matriculas" class="btn btn-info text-white btn-lg w-100 py-4 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-4 mb-2">ğŸ“</span> Matricular Estudiantes
                </a>
            </div>
            <div class="col-md-4">
                <a href="/docente/planillas" class="btn btn-warning btn-lg w-100 py-4 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-4 mb-2">âœï¸</span> Panel Docente (Notas)
                </a>
            </div>
            <div class="col-md-4">
                <a href="/admin/boletines" class="btn btn-danger btn-lg w-100 py-4 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-4 mb-2">ğŸ“„</span> Generar Boletines PDF
                </a>
            </div>
        <% } %>

        <% if (usuario.rol === 'ESTUDIANTE') { %>
            <div class="col-md-6">
                <a href="/estudiante/mis-notas" class="btn btn-primary btn-lg w-100 py-5 shadow-sm d-flex flex-column align-items-center">
                    <span class="fs-1 mb-2">ğŸ“Š</span>
                    <span class="fw-bold">Ver Mis Calificaciones y Ranking</span>
                    <small class="text-white-50 mt-2">Consulta tu desempeÃ±o y puesto actual</small>
                </a>
            </div>
        <% } %>

    </div>
</div>

<script>
    function confirmarSalida() {
        Swal.fire({
            title: 'Â¿Desea salir del sistema?',
            text: "Seleccione si desea cambiar de usuario o apagar el programa completamente.",
            icon: 'question',
            showDenyButton: true,
            showCancelButton: true,
            confirmButtonText: 'ğŸ”„ Cambiar Usuario (Cerrar SesiÃ³n)',
            denyButtonText: 'ğŸ›‘ Apagar Programa',
            cancelButtonText: 'Cancelar',
            confirmButtonColor: '#3085d6',
            denyButtonColor: '#d33'
        }).then((result) => {
            if (result.isConfirmed) {
                // OpciÃ³n 1: Solo cerrar sesiÃ³n y volver al login
                window.location.href = '/logout';
            } else if (result.isDenied) {
                // OpciÃ³n 2: Matar el proceso y la ventana
                window.location.href = '/shutdown';
            }
        });
    }
</script>

</body>
</html>